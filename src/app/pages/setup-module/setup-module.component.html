<div class="main-container">
  <div class="left-panel">
    <button class="mobile-menu-button" (click)="toggleMenu()">
      <i data-eva="person-outline"></i>
    </button>

    <div class="loading-wrapper" *ngIf="loadingModulos">
      <div class="premium-loader-container">
        <div class="loader-glass-card">
          <div class="spinner-box">
            <div class="circle-outer"></div>
            <div class="circle-inner"></div>
            <img src="assets/img/cordero.png" class="loader-logo-mini" alt="loading">
          </div>
          <div class="loading-text-content">
            <span class="main-loading-text">Verificando Credenciales</span>
            <div class="loading-bar-container">
              <div class="loading-bar-progress"></div>
            </div>
            <span class="sub-loading-text">Sincronizando tus módulos de acceso...</span>
          </div>
        </div>
      </div>
    </div>

    <div class="modules-wrapper" *ngIf="!loadingModulos && modulos.length > 0">
      <div class="module-card" *ngFor="let modulo of modulos" (click)="goToAccess(modulo)">
        <img *ngIf="isImg(modulo._view)" [src]="modulo._view.src" class="module-icon img">
        <span *ngIf="isMs(modulo._view)" class="module-icon material" [ngClass]="modulo._view.variantClass">{{ modulo._view.name }}</span>
        <i *ngIf="isFa(modulo._view)" class="module-icon fa" [ngClass]="modulo._view.classes"></i>
        <span *ngIf="isEva(modulo._view)" class="module-icon eva-holder"><i [attr.data-eva]="modulo._view.name"></i></span>
        <iconify-icon *ngIf="isIfy(modulo._view)" class="module-icon" [attr.icon]="modulo._view.icon"></iconify-icon>
        <div class="module-name">{{ modulo.nombre }}</div>
      </div>
    </div>

    <div class="premium-empty-overlay" *ngIf="!loadingModulos && modulos.length === 0">
      <div class="premium-glass-card">
        <div class="premium-icon-sphere">
          <iconify-icon icon="line-md:alert-circle-loop" class="premium-icon-anim"></iconify-icon>
        </div>
        <div class="premium-content">
          <h2 class="premium-title">Acceso Restringido</h2>
          <div class="premium-divider"></div>
          <p class="premium-main-text">No hemos encontrado módulos activos vinculados a tu cuenta en este momento.</p>
          <div class="premium-badge">
            <iconify-icon icon="solar:shield-warning-bold-duotone"></iconify-icon>
            Requiere Gestión de Permisos
          </div>
          <p class="premium-footer-text">
            Por favor, contacta al administrador para solicitar accesos al sistema.
          </p>
        </div>
      </div>
    </div>
  </div>

  <div class="right-panel" [class.is-open]="isMenuOpen">
    <div class="user-info-card" *ngIf="user$ | async as user; else loadingUser">
      <button class="close-menu-button" (click)="toggleMenu()">
        <i data-eva="close-outline"></i>
      </button>

      <img src="assets/img/upeu-logo.png" alt="Logo" class="user-logo" />

      <div class="user-code">
        <span class="label">Código:</span>
        <span class="value">{{ user.codigo }}</span>
      </div>

      <div class="user-full-name">
        <span class="user-name-line">{{ user.person?.nombre }}</span>
        <span class="user-name-line">
          {{ user.person?.paterno }} {{ user.person?.materno }}
        </span>
      </div>

      <button class="logout-button" (click)="salir()">SALIR</button>
    </div>

    <ng-template #loadingUser>
      <div class="user-info-card">
        <p>Cargando información...</p>
      </div>
    </ng-template>
  </div>
</div>